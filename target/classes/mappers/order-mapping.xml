<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
    
<mapper namespace="OrderMapper">

  <select id="getOrderList" parameterType="order" resultType="order">
        SELECT *
        FROM 'ORDER'
        WHERE 1=1
        <if test="userId != null">
            AND user_id = #{userId}
        </if>
        <if test="status != null and status != ''">
            AND status = #{status}
        </if>
        ORDER BY order_date DESC
    </select>
    
     <select id="getOrder" parameterType="int" resultType="order">
        SELECT *
        FROM 'ORDER'
        WHERE order_id = #{orderId}
    </select>
    
    <insert id="insertOrder" parameterType="order">
        INSERT INTO 'ORDER' (
            user_id,
            status,
            order_date,
            total_amount,
            order_name
        ) VALUES (
            #{userId},
            #{status},
            #{orderDate},
            #{totalAmount},
            #{orderName}
        )
    </insert>
    
    <update id="updateOrder" parameterType="order">
        UPDATE 'ORDER'
        SET
            status = #{status},
            total_amount = #{totalAmount},
            order_name = #{orderName}
        WHERE order_id = #{orderId}
    </update>
    
    <delete id="deleteOrder" parameterType="int">
        DELETE FROM 'ORDER'
        WHERE order_id = #{orderId}
    </delete>
<!-- 주문 취소, 환불 수 확인   -->
    <select id="getTotalOrderCount" resultType="long">
        SELECT COUNT(*)
        FROM 'ORDER'
        WHERE status != '주문취소','주문환불'
    </select>

    <select id="getCancelledOrderCount" resultType="long">
        SELECT COUNT(*)
        FROM 'ORDER'
        WHERE status = '주문취소','주문환불'
    </select>
</mapper>